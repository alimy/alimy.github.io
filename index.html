    <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<head>
	<meta name="generator" content="Hugo 0.155.3">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title> 北野 &middot; 那年江湖，遇见你 </title>
  
  <link rel="stylesheet" type="text/css" href="https://alimy.github.io//css/uno.css" />
  <link rel="stylesheet" type="text/css" href="https://alimy.github.io//css/lightGallery.css" />
  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://alimy.github.io/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://alimy.github.io/favicon.png">
  
  <script src="https://alimy.github.io//js/jquery.min.js"></script>
  <script src="https://alimy.github.io//js/main.min.js"></script>

  <script data-host="https://riiffy.com" data-dnt="false" src="https://riiffy.com/js/script.js" id="ZwSg9rf6GA" async
    defer></script>

  <style type="text/css">
    body {
      background-color: #f9f9f9;
    }

    .panel-wrapper {
      box-shadow: 0px 0px 8px rgba(68, 68, 68, .6);
      -moz-box-shadow: 0px 0px 8px rgba(68, 68, 68, .6);
      border-radius: 4px;
      -moz-border-radius: 4px;
      padding: 16px 24px;
      margin-top: 32px;
      background-color: #fff
    }

    .panel-wrapper:hover {
      box-shadow: 0px 0px 12px rgba(68, 68, 68, .6);
      -moz-box-shadow: 0px 0px 12px rgba(68, 68, 68, .6);
    }

    #more {
      margin-top: 16px;
    }

    #copyright {
      padding: 2em 0 0;
      display: block;
      font-size: .9em;
      color: #b3b3b3;
      width: 100%;
      text-align: center
    }

    #list-indicator {
      min-width: 48px;
      text-align: center;
      float: right;
      margin-right: 64px;
      background: rgba(68, 68, 68, .2);
      border-radius: 4px;
      -moz-border-radius: 4px;
      padding: 8px;
    }

    #list-date {
      color: #999;
      font-size: .9em;
      font-style: italic;
    }

    .post-tags-item {
      padding-left: .75rem !important;
      padding-right: .75rem !important;
      padding-top: .25rem !important;
      padding-bottom: .25rem !important;
      margin-right: .5rem !important;
      margin-top: .25rem !important;
      margin-bottom: .25rem !important;
      font-size: .875rem !important;
      color: #666666;
      display: inline-block !important;
      border-radius: .25rem !important;
      background-color: rgb(242 242 247) !important;
    }

    .post-tags-item:hover {
      color: #38b2ac;
    }

    #post-navigator {
      padding: 24px 0px 16px 0px;
      vertical-align: middle;
    }

    #post-navigator>a {
      display: block;
      color: #2479cc;
      text-decoration: none;
    }

    #post-navigator-prev {
      float: left;
    }

    #post-navigator-next {
      float: right;
    }

    .pages {
      text-align: center;
      margin-right: -15px;
      margin-left: -15px;
    }

    .pages>ul {
      font-weight: lighter;
    }

    .pages>.pagination {
      display: inline-block;
      padding-left: 0;
      margin: 20px 0px;
      border-radius: 4px;
    }

    .pages .pagination>li {
      display: inline;
    }

    .pagination>.active>a,
    .pagination>.active>span,
    .pagination>.active>a:hover,
    .pagination>.active>span:hover,
    .pagination>.active>a:focus,
    .pagination>.active>span:focus {
      z-index: 2;
      color: #fff;
      cursor: default;
      background-color: #428bca;
      border-color: #428bca;
    }

    .pagination>li>a,
    .pagination>li>span {
      position: relative;
      float: left;
      padding: 6px 12px;
      margin-left: -1px;
      line-height: 1.428571429;
      text-decoration: none;
      background-color: #fff;
      border: 1px solid #ddd;
    }

    .pagination>li:first-child>a,
    .pagination>li:first-child>span {
      margin-left: 0;
      border-bottom-left-radius: 4px;
      border-top-left-radius: 4px;
    }

    .pagination>.disabled>span,
    .pagination>.disabled>span:hover,
    .pagination>.disabled>span:focus,
    .pagination>.disabled>a,
    .pagination>.disabled>a:hover,
    .pagination>.disabled>a:focus {
      color: #999;
      cursor: not-allowed;
      background-color: #fff;
      border-color: #ddd;
    }

    .pagination>li:last-child>a,
    .pagination>li:last-child>span {
      border-top-right-radius: 4px;
      border-bottom-right-radius: 4px;
    }

    *,
    *:before,
    *:after {
      -webkit-box-sizing: border-box;
      -moz-box-sizing: border-box;
      box-sizing: border-box;
    }
  </style>
</head>
    <body>
        <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
        <i class="fa fa-bars btn-mobile-menu__icon"></i>
        <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
         panel-cover panel-cover--collapsed  " 
        style="background-image: url(/images/cover.jpg)" >
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content">
                    <a href="https://alimy.github.io//"> <img src="https://alimy.github.io/images/logo.jpg"
                            width="256" alt="北野 logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="https://alimy.github.io//">北野</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  那年江湖，遇见你  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                                <li class="navigation__item"><a href="https://alimy.github.io/" title="博客首页"
                                        class="blog-button">首页</a> </li> </br></br>
                                <li class="navigation__item"><a href="https://alimy.github.io/post" title="文章列表"
                                        class="blog-button">文章列表</a> </li>
                                </br>  </br>
                                <li class="navigation__item"><a href="https://alimy.github.io/pages/cv" title="关于我 "
                                        class="blog-button">关于我</a> </li>
                                </br> 
                            </ul>
                            <nav class="cover-navigation navigation--social">
</br>
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="https://iibiubiu.com" title="@iiBiuBiu" target="_blank"> <i class='fa fa-anchor'></i> <span class="label">Twitter</span> </a>
        </li>
        <li class="navigation__item">
            <a href="https://www.paopao.info/#/u?s=alimy" title="@paopao" target="_blank"> <i class='fa fa-leaf'></i> <span class="label">Twitter</span> </a>
        </li><br>
        
        
        
          
        
        <li class="navigation__item">
            <a href="https://github.com/alimy" title="@GitHub" target="_blank"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>   </br>    </ul>
</nav>

                        </nav>
                    </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</div>
<noscript>
    <style>
        #scriptHeader {
            display: none;
        }

        .navigation-wrapper {
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="https://alimy.github.io//"> <img src="https://alimy.github.io/images/logo.jpg" width="80"
                            alt="北野 logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="https://alimy.github.io//">北野</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  那年江湖，遇见你  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                                <li class="navigation__item"><a href="https://alimy.github.io/" title="博客首页"
                                        class="blog-button">Blog</a> </li></br></br>
                                <li class="navigation__item"><a href="https://alimy.github.io//post/" title="文章列表"
                                        class="blog-button">Articles</a> </li>
                                </br>  </br>
                                <li class="navigation__item"><a href="https://alimy.github.io/pages/cv" title="关于我 "
                                        class="blog-button">About Me</a> </li>
                                </br> 
                            </ul>
                        </nav> <nav class="cover-navigation navigation--social">
</br>
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="https://iibiubiu.com" title="@iiBiuBiu" target="_blank"> <i class='fa fa-anchor'></i> <span class="label">Twitter</span> </a>
        </li>
        <li class="navigation__item">
            <a href="https://www.paopao.info/#/u?s=alimy" title="@paopao" target="_blank"> <i class='fa fa-leaf'></i> <span class="label">Twitter</span> </a>
        </li><br>
        
        
        
          
        
        <li class="navigation__item">
            <a href="https://github.com/alimy" title="@GitHub" target="_blank"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>   </br>    </ul>
</nav>

                    </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>
        <div class="content-wrapper">
            <div class="content-wrapper__inner">
                <section id="main">
                    <div>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/dev_202602200858/" title="阅读全文">Go - 巧用Constraint接口实现约束 </a> </h2>
        
    </header>
    <div class="summary">
        <p>在Go开发中，通常会使用类似 <code>var _ core.TweetSearchService = (*bridgeTweetSearchServant)(nil)</code> 的语句借助Go编译器在 <strong>编译期</strong> 检测某个类型是否完全实现了某个接口的所有方法，比如此例， 如果 <code>*bridgeTweetSearchServant</code> 缺失 接口 <code>core.TweetSearchService</code> 的某些方法实现，Go将会在编译期报错，不能成功编译App.</p>
<p>在工程实践中，可以在 <strong>包内</strong> 将这类 <strong>接口实现约束（Constraint）</strong> 语句 统一放在 <code>constraint.go</code> 中，并添加 <em>build tag</em> <code>//go:build constraint</code> 使用tag条件编译机制，只有在使用 <code>go build -tags constraint</code> 时才会进行接口实现约束的检测，在编译产品App时就不带 <code>constraint</code> tag，也就不会把这些 <strong>只应在开发期有效的语句</strong> 编译到最终的App中。</p>
<p>以下是 <a href="https://github.com/rocboss/paopao-ce/blob/dev/internal/dao/search/constraint.go" title="清新文艺微社区">『paopao-ce』</a> 的一个使用实例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// file: https://github.com/rocboss/paopao-ce/blob/dev/internal/dao/search/constraint.go</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//go:build constraint</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">search</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;github.com/rocboss/paopao-ce/internal/core&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">TweetSearchService</span> = (<span style="color:#f92672">*</span><span style="color:#a6e22e">bridgeTweetSearchServant</span>)(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">TweetSearchService</span> = (<span style="color:#f92672">*</span><span style="color:#a6e22e">meiliTweetSearchServant</span>)(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">VersionInfo</span>        = (<span style="color:#f92672">*</span><span style="color:#a6e22e">meiliTweetSearchServant</span>)(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">TweetSearchService</span> = (<span style="color:#f92672">*</span><span style="color:#a6e22e">zincTweetSearchServant</span>)(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">VersionInfo</span>        = (<span style="color:#f92672">*</span><span style="color:#a6e22e">zincTweetSearchServant</span>)(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/dev_202602200858/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/dev_202602151705/" title="阅读全文">Building a message queue with only two UNIX signals </a> </h2>
        
    </header>
    <div class="summary">
        <p>Have you ever asked yourself what if we could replace any message broker with a very simple one using only two UNIX signals? Well, I’m not surprised if you didn’t. But I did. And I want to share my journey of how I achieved it.</p>
<p>If you want to learn about UNIX signals, binary operations the easy way, how a message broker works under the hood, and a bit of Ruby, this post is for you.</p>
<p>And if you came here just because of the clickbait title, I apologize and invite you to keep reading. It’ll be fun, I promise.</p>
<p><img src="https://alimy.github.io/images/post/20260215170500.png" alt="image"></p>
<h3 id="its-all-about-unix">It’s all about UNIX</h3>
<p>A few days ago, I saw some discussion on the internet about how we could send messages between processes. Many people think of sockets, which are the most common way to send messages, even allowing communication across different machines and networks. Some don’t even realize that pipes are another way to send messages between processes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ echo <span style="color:#e6db74">&#39;hello&#39;</span> | base64
</span></span><span style="display:flex;"><span>aGVsbG8K
</span></span></code></pre></div>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/dev_202602151705/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/dev_202602141920/" title="阅读全文">rpcx - 消息协议 </a> </h2>
        
    </header>
    <div class="summary">
        <p>rpcx 的 请求(request)和响应(response)使用相同的数据结构。</p>
<p><img src="https://alimy.github.io/images/post/20260214192000.jpg" alt=""></p>
<p>一个消息由下面的项组成:</p>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/dev_202602141920/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/dev_202602141900/" title="阅读全文">Kitex TTHeader协议 </a> </h2>
        
    </header>
    <div class="summary">
        <p>参考 <a href="https://github.com/apache/thrift/blob/master/doc/specs/HeaderFormat.md">Thrift THeader 协议</a> ，Kitex设计了 TTheader 协议。</p>
<h4 id="协议编码">协议编码</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">9</span> a b c d e f <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">9</span> a b c d e f
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>| 0|                          LENGTH                             |
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>| 0|       HEADER MAGIC          |            FLAGS              |
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>|                         SEQUENCE NUMBER                        |
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>| 0|     HEADER SIZE             | ...
</span></span><span style="display:flex;"><span>+---------------------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                  Header is of variable size:
</span></span><span style="display:flex;"><span>                   <span style="color:#f92672">(</span>and starts at offset 14<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>| PROTOCOL ID  |NUM TRANSFORMS . |TRANSFORM <span style="color:#ae81ff">0</span> ID <span style="color:#f92672">(</span>uint8<span style="color:#f92672">)</span>|
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>|  TRANSFORM <span style="color:#ae81ff">0</span> DATA ...
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>|         ...                              ...                   |
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>| INFO <span style="color:#ae81ff">0</span> ID <span style="color:#f92672">(</span>uint8<span style="color:#f92672">)</span>|       INFO <span style="color:#ae81ff">0</span>  DATA ...
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>|         ...                              ...                   |
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>|                                                                |
</span></span><span style="display:flex;"><span>|                              PAYLOAD                           |
</span></span><span style="display:flex;"><span>|                                                                |
</span></span><span style="display:flex;"><span>+----------------------------------------------------------------+
</span></span></code></pre></div>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/dev_202602141900/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/dev_202602141850/" title="阅读全文">Thrift THeader协议 </a> </h2>
        
    </header>
    <div class="summary">
        <p>Header format for the THeader.h</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>      <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">9</span> a b c d e f <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">8</span> <span style="color:#ae81ff">9</span> a b c d e f
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    | 0|                          LENGTH                             |
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    | 0|       HEADER MAGIC          |            FLAGS              |
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    |                         SEQUENCE NUMBER                        |
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    | 0|     Header Size<span style="color:#f92672">(</span>/32<span style="color:#f92672">)</span>        | ...
</span></span><span style="display:flex;"><span>    +---------------------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                      Header is of variable size:
</span></span><span style="display:flex;"><span>                       <span style="color:#f92672">(</span>and starts at offset 14<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    |         PROTOCOL ID  <span style="color:#f92672">(</span>varint<span style="color:#f92672">)</span>  |   NUM TRANSFORMS <span style="color:#f92672">(</span>varint<span style="color:#f92672">)</span>     |
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    |      TRANSFORM <span style="color:#ae81ff">0</span> ID <span style="color:#f92672">(</span>varint<span style="color:#f92672">)</span>   |        TRANSFORM <span style="color:#ae81ff">0</span> DATA ...
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    |         ...                              ...                   |
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    |        INFO <span style="color:#ae81ff">0</span> ID <span style="color:#f92672">(</span>varint<span style="color:#f92672">)</span>      |       INFO <span style="color:#ae81ff">0</span>  DATA ...
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    |         ...                              ...                   |
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span><span style="display:flex;"><span>    |                                                                |
</span></span><span style="display:flex;"><span>    |                              PAYLOAD                           |
</span></span><span style="display:flex;"><span>    |                                                                |
</span></span><span style="display:flex;"><span>    +----------------------------------------------------------------+
</span></span></code></pre></div><p>The <code>LENGTH</code> field is 32 bits, and counts the remaining bytes in the
packet, NOT including the length field.  The header size field is 16
bits, and defines the size of the header remaining NOT including the
<code>HEADER MAGIC</code>, <code>FLAGS</code>, <code>SEQUENCE NUMBER</code> and header size fields.  The
Header size field is in bytes/4.</p>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/dev_202602141850/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/dev_202602131240/" title="阅读全文">妙用Go类型定义避免循环引用 </a> </h2>
        
    </header>
    <div class="summary">
        <h4 id="类型定义type-definition">类型定义（Type Definition）</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">MyInt</span> <span style="color:#66d9ef">int</span>
</span></span></code></pre></div><ul>
<li>创建一个<strong>新类型</strong>，与底层类型（underlying type）不同。</li>
<li>新类型拥有独立的类型集，<strong>不会继承底层类型的方法</strong>。</li>
<li>需要进行<strong>显式类型转换才能与底层类型互用</strong>。</li>
</ul>
<h4 id="巧妙使用类型定义来避免对象实例方法循环调用">巧妙使用类型定义来避免对象实例方法循环调用</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// file: github.com/powerman/rpc-codec/blob/master/jsonrpc2/client.go</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">clientResponse</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Version</span> <span style="color:#66d9ef">string</span>           <span style="color:#e6db74">`json:&#34;jsonrpc&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ID</span>      <span style="color:#f92672">*</span><span style="color:#66d9ef">uint64</span>          <span style="color:#e6db74">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Result</span>  <span style="color:#f92672">*</span><span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">RawMessage</span> <span style="color:#e6db74">`json:&#34;result,omitempty&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Error</span>   <span style="color:#f92672">*</span><span style="color:#a6e22e">Error</span>           <span style="color:#e6db74">`json:&#34;error,omitempty&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">clientResponse</span>) <span style="color:#a6e22e">reset</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Version</span> = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">ID</span> = <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Result</span> = <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Error</span> = <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">clientResponse</span>) <span style="color:#a6e22e">UnmarshalJSON</span>(<span style="color:#a6e22e">raw</span> []<span style="color:#66d9ef">byte</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">reset</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">resp</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">clientResponse</span> <span style="color:#75715e">// 非常关键的一个动作，要身不要心</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Unmarshal</span>(<span style="color:#a6e22e">raw</span>, <span style="color:#a6e22e">resp</span>(<span style="color:#a6e22e">r</span>)); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;bad response: &#34;</span> <span style="color:#f92672">+</span> string(<span style="color:#a6e22e">raw</span>))
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">o</span> = make(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#f92672">*</span><span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">RawMessage</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Unmarshal</span>(<span style="color:#a6e22e">raw</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">o</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;bad response: &#34;</span> <span style="color:#f92672">+</span> string(<span style="color:#a6e22e">raw</span>))
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// ...other logic...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/dev_202602131240/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/art_202602060918/" title="阅读全文">女孩 </a> </h2>
        
    </header>
    <div class="summary">
        <p><a href="https://alimy.github.io/images/post/20260206091800.jpg" title="点击查看大图"><img src="https://alimy.github.io/images/post/20260206091801.jpg" alt=""></a></p>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/art_202602060918/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/etc_202602031028/" title="阅读全文">&#34;兄弟&#34; </a> </h2>
        
    </header>
    <div class="summary">
        <p><img src="https://alimy.github.io/images/post/20260203102800.png" alt=""></p>
<p>李奔腾： &ldquo;我现在&hellip;自身难保”</p>
<p>李奔腾： “跟我一起创业的老兄弟不会放过我的&rdquo;</p>
<p>李奔腾： &ldquo;我有可能&hellip;&rdquo;</p>
<p>李奔腾： &ldquo;要被迫放弃麒麟&rdquo;</p>
<p>李奔腾： “不过也挺好的，<strong>一无所有也是一个新的开始</strong> ”</p>
<p>罗 维： “所以&hellip;对于你来说，到底是生意更重要，还是兄弟更重要？”</p>
<p>李奔腾： “ <strong>不做一个梦，就不算兄弟</strong> ”</p>
<p>李奔腾： “生意，一点都不重要”</p>
<p>&hellip;&hellip;</p>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/etc_202602031028/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/dev_202602011415/" title="阅读全文">git-sync同步所有git库 </a> </h2>
        
    </header>
    <div class="summary">
        <p>同步指定目录中所有git库的一个简单shell脚本。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git sync -maxdepth <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>&gt; Found <span style="color:#ae81ff">89</span> repositories.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; Synching gin 1% <span style="color:#f92672">(</span>1/89<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Already up to date.
</span></span><span style="display:flex;"><span>&gt; Synching gin finish.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; Synching yj 2% <span style="color:#f92672">(</span>2/89<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Already up to date.
</span></span><span style="display:flex;"><span>&gt; Synching yj finish.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; Synching go-cmp 3% <span style="color:#f92672">(</span>3/89<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Already up to date.
</span></span><span style="display:flex;"><span>&gt; Synching go-cmp finish.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; Synching opentelemetry-go-contrib 4% <span style="color:#f92672">(</span>4/89<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>remote: Enumerating objects: 775, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Counting objects: 100% <span style="color:#f92672">(</span>363/363<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Compressing objects: 100% <span style="color:#f92672">(</span>117/117<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Total <span style="color:#ae81ff">775</span> <span style="color:#f92672">(</span>delta 264<span style="color:#f92672">)</span>, reused <span style="color:#ae81ff">307</span> <span style="color:#f92672">(</span>delta 240<span style="color:#f92672">)</span>, pack-reused <span style="color:#ae81ff">412</span> <span style="color:#f92672">(</span>from 3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Receiving objects: 100% <span style="color:#f92672">(</span>775/775<span style="color:#f92672">)</span>, 351.23 KiB | 636.00 KiB/s, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Resolving deltas: 100% <span style="color:#f92672">(</span>448/448<span style="color:#f92672">)</span>, completed with <span style="color:#ae81ff">79</span> local objects.
</span></span></code></pre></div>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/dev_202602011415/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                            <article class="post panel-wrapper">
    <header>
        <h2><a href="https://alimy.github.io/post/dev_202601241258/" title="阅读全文">TL在Go如何实现oneof语义 </a> </h2>
        
    </header>
    <div class="summary">
        <p>TL的Type是一个总类型<code>Class</code>包含不同的结构子类型实例<code>Object</code>，类似于Protubuf中<code>Message</code>与<code>Oneof</code>的关系。</p>
<h4 id="telegram的rpc-tl片段1">Telegram的RPC TL片段1：</h4>
<pre tabindex="0"><code class="language-tl" data-lang="tl">peerUser#9db1bc6d user_id:int = Peer;
peerChat#bad0e5bb chat_id:int = Peer;
peerChannel#bddde532 channel_id:int = Peer;

folderPeer#e9baa668 peer:Peer folder_id:int = FolderPeer;
</code></pre>
    </div>
    <footer id="more">
        <a href='https://alimy.github.io/post/dev_202601241258/' title="继续阅读">阅读全文<nobr>&nbsp;<i class="fa fa-caret-right" aria-hidden="true"></i>
            </nobr></a>
    </footer>
</article>
                        
                    </div>
                    </br>
                    
                </section>
                <div class="pages">
  
<ul class="pagination">
  
  <li class="page-item disabled">
    <a  class="page-link" aria-label="Previous"><span
        aria-hidden="true"><i class="fa fa-arrow-left" aria-hidden="true"></i>&nbsp;&nbsp;上一页</span></a>
  </li>
  <li class="page-item active">
    <a class="page-link" href="https://alimy.github.io/">1</a>
  </li>
  <li class="page-item">
    <a class="page-link" href="https://alimy.github.io/page/2/">2</a>
  </li>
  <li class="page-item">
    <a class="page-link" href="https://alimy.github.io/page/3/">3</a>
  </li>
  <li class="page-item disabled">
    <span aria-hidden="true">&nbsp;&hellip;&nbsp;</span>
  </li>
  <li class="page-item">
    <a class="page-link" href="https://alimy.github.io/page/19/">19</a>
  </li>
  <li class="page-item">
    <a href="https://alimy.github.io/page/2/"  class="page-link" aria-label="Next">下一页&nbsp;&nbsp;<i
        class="fa fa-arrow-right" aria-hidden="true"></i></a>
  </li>
  
</ul>

</div>

            <footer id="copyright">
  <p>&copy;2015-至今 <a href="mailto:alimy@niubiu.com" title="Email:alimy@niubiu.com">北野 - Michael Li</a> All rights
    reserved.&nbsp;&nbsp;<a href="https://riiffy.com/alimy.github.io" title="访问统计" target="_blank">Riiffy</p>
</footer>
            </div>
        </div>
        <script>(function(){var WebP=new Image();WebP.onload=WebP.onerror=function(){
if(WebP.height!=2){var sc=document.createElement('script');sc.type='text/javascript';sc.async=true;
var s=document.getElementsByTagName('script')[0];sc.src='https://alimy.github.io/js/webpjs-0.0.2.min.js';s.parentNode.insertBefore(sc,s);}};
WebP.src='data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA';})();</script>

    </body>
</html>
